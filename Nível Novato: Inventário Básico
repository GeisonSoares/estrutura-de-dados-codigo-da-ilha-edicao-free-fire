#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <stdbool.h> // Mantido para futuras adaptações, embora não seja estritamente usado

// Código da Ilha – Edição Free Fire
// Nível: Novato
// Este programa simula o gerenciamento básico de uma mochila com componentes coletados durante a fuga de uma ilha.
// Foco em manipulação de structs e arrays.

// ------------------------------------------------
// Definições de Estruturas e Constantes
// ------------------------------------------------

#define MAX_SLOTS 10 // Capacidade máxima de itens

// Struct Item:
// Representa um componente com nome, tipo e quantidade.
typedef struct {
    char nome[30];
    char tipo[20];
    int quantidade;
} Item;

// ------------------------------------------------
// Variáveis Globais (Vetor mochila e Controles)
// ------------------------------------------------

// Vetor mochila:
// Armazena até 10 itens coletados.
Item mochila[MAX_SLOTS];

// Variáveis de controle:
int numItens = 0; // quantidade atual

// ------------------------------------------------
// Protótipos das Funções
// ------------------------------------------------

void limparBuffer();
void limparTela();
void exibirMenu();
void listarItens();
void inserirItem();
void removerItem(); // Removeremos pelo índice para manter a simplicidade do Novato

// ------------------------------------------------
// Implementação das Funções
// ------------------------------------------------

// limparTela():
// Simula a limpeza da tela imprimindo várias linhas em branco.
void limparTela() {
    #ifdef _WIN32
        system("cls");
    #else
        system("clear");
    #endif
}

// limparBuffer():
// Limpa o buffer de entrada do teclado.
void limparBuffer() {
    int c;
    while ((c = getchar()) != '\n' && c != EOF) {}
}

// exibirMenu():
// Apresenta o menu principal ao jogador.
void exibirMenu() {
    printf("\n=========================================\n");
    printf("MOCHILA DE LOOT - NÍVEL NOVATO\n");
    printf("-----------------------------------------\n");
    printf("1. Adicionar um item\n");
    printf("2. Remover um item pela Posição\n");
    printf("3. Listar todos os itens\n");
    printf("0. Sair\n");
    printf("Escolha: ");
}

// inserirItem():
// Adiciona um novo componente à mochila se houver espaço.
// Solicita nome, tipo e quantidade.
void inserirItem() {
    if (numItens >= MAX_SLOTS) {
        printf("\n[ALERTA] Mochila cheia! (%d/%d slots)\n", numItens, MAX_SLOTS);
        return;
    }

    Item novo;
    printf("\n--- Adicionar Item ---\n");

    printf("Nome: ");
    limparBuffer();
    if (fgets(novo.nome, sizeof(novo.nome), stdin) == NULL) return;
    novo.nome[strcspn(novo.nome, "\n")] = 0;

    printf("Tipo (ex: Arma, Cura): ");
    if (scanf("%19s", novo.tipo) != 1) { limparBuffer(); return; }

    printf("Quantidade: ");
    if (scanf("%d", &novo.quantidade) != 1 || novo.quantidade <= 0) {
        printf("[ERRO] Quantidade inválida.\n"); limparBuffer(); return;
    }

    mochila[numItens] = novo;
    numItens++;

    printf("\n[SUCESSO] '%s' adicionado.\n", novo.nome);
    listarItens();
}

// removerItem():
// Permite remover um componente da mochila pela POSIÇÃO.
void removerItem() {
    int indiceRemover, posicao;

    if (numItens == 0) {
        printf("\nA mochila está vazia. Nada para remover.\n");
        return;
    }

    listarItens();
    printf("\n--- Remover Item ---\n");
    printf("Digite o NÚMERO da posição (1 a %d) do item para remover: ", numItens);

    if (scanf("%d", &posicao) != 1) {
        printf("[ERRO] Entrada inválida. Use apenas números.\n");
        limparBuffer();
        return;
    }

    indiceRemover = posicao - 1;

    if (indiceRemover < 0 || indiceRemover >= numItens) {
        printf("[ERRO] Posição %d não é válida.\n", posicao);
        return;
    }

    char nomeRemovido[30];
    strcpy(nomeRemovido, mochila[indiceRemover].nome);

    // Reorganiza o vetor (deslocamento)
    for (int i = indiceRemover; i < numItens - 1; i++) {
        mochila[i] = mochila[i + 1];
    }

    numItens--;

    printf("\n[SUCESSO] Item '%s' (Posição %d) removido.\n", nomeRemovido, posicao);
    listarItens();
}

// listarItens():
// Exibe uma tabela formatada com todos os componentes presentes na mochila.
void listarItens() {
    printf("\n--- Conteúdo da Mochila ---\n");
    printf("------------------------------------------------------\n");

    if (numItens == 0) {
        printf("A mochila está vazia.\n");
        printf("------------------------------------------------------\n");
        return;
    }

    printf("Pos | Nome                      | Tipo            | Qtd\n");
    printf("------------------------------------------------------\n");
    for (int i = 0; i < numItens; i++) {
        Item item = mochila[i];
        printf("%02d  | %-25s | %-15s | %d\n",
               i + 1, item.nome, item.tipo, item.quantidade);
    }
    printf("------------------------------------------------------\n");
}

// ------------------------------------------------
// Função Principal
// ------------------------------------------------

int main() {
    int escolha;
    
    limparTela();
    printf("**********************************************\n");
    printf("* Código da Ilha – Edição Free Fire (Nível Novato) *\n");
    printf("**********************************************\n");

    // Menu principal com opções:
    // 1. Adicionar um item
    // 2. Remover um item
    // 3. Listar todos os itens
    // 0. Sair

    do {
        exibirMenu();
        
        if (scanf("%d", &escolha) != 1) {
            printf("\n[ERRO] Opção inválida. Digite um número.\n");
            escolha = -1;
            limparBuffer();
        }

        // A estrutura switch trata cada opção chamando a função correspondente.
        switch (escolha) {
            case 1: inserirItem(); break;
            case 2: removerItem(); break;
            case 3: listarItens(); break;
            case 0: printf("\nFechando o sistema. Missão concluída (Nível Novato).\n"); break;
            default: printf("\nOpção desconhecida. Tente novamente.\n");
        }
    } while (escolha != 0);

    return 0;
}